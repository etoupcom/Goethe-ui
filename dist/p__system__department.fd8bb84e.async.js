(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[984],{90990:function(fe,P,t){"use strict";t.r(P),t.d(P,{default:function(){return ae}});var he=t(58024),W=t(39144),ve=t(13254),L=t(14277),xe=t(89816),X=t(28684),je=t(62350),Y=t(75443),Fe=t(48736),$=t(27049),Ee=t(57663),D=t(71577),x=t(11849),Ce=t(34792),m=t(48086),j=t(2824),f=t(67294),b=t(43653),w=t(81907),pe=t(57338),N=t(25084),Ze=t(13062),M=t(71230),ge=t(43358),G=t(16317),ye=t(89032),o=t(15746),Be=t(47673),h=t(4107),De=t(9715),u=t(86585),e=t(85893),q=function(l){var F=l.options,n=l.parent,E=l.visible,I=l.onCancel,C=l.onCreated,y=u.Z.useForm(),p=(0,j.Z)(y,1),r=p[0],Z=function(){I(r)},g=function(){r.validateFields().then(function(c){C(n?(0,x.Z)((0,x.Z)({},c),{},{parent_id:n.id}):c,r)}).catch(function(c){var B=c.errorFields;B.length>0&&m.default.error("\u8BF7\u5B8C\u6210\u5FC5\u586B\u9879\u5185\u5BB9")})};return(0,e.jsx)(N.Z,{title:"\u65B0\u5EFA\u90E8\u95E8",width:450,visible:E,onClose:Z,maskClosable:!1,footer:(0,e.jsx)("div",{style:{textAlign:"right",marginRight:10},children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{onClick:Z,style:{marginRight:10},children:"\u5173\u95ED"}),(0,e.jsx)(D.Z,{type:"primary",onClick:g,style:{marginRight:10},children:"\u4FDD\u5B58"})]})}),children:(0,e.jsx)(u.Z,{layout:"vertical",form:r,onFinish:g,children:(0,e.jsxs)(M.Z,{gutter:[16,16],children:[n&&(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{label:"\u4E0A\u7EA7\u90E8\u95E8",children:(0,e.jsx)(h.Z,{value:n.name,disabled:!0,placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"name",label:"\u90E8\u95E8\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90E8\u95E8\u540D\u79F0"}],children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u540D\u79F0"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"contact",label:"\u90E8\u95E8\u7535\u8BDD",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90E8\u95E8\u7535\u8BDD"}],children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u7535\u8BDD"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"description",label:"\u90E8\u95E8\u63CF\u8FF0",children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u63CF\u8FF0"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"project_id",label:"\u6240\u5C5E\u9879\u76EE",children:(0,e.jsx)(G.Z,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u9879\u76EE",options:F})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"sort",label:"\u6392\u5E8F",children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u6392\u5E8F \u6B63\u5E8F\u6392\u5E8F"})})})]})})})},K=q,_=function(l){var F=l.options,n=l.fields,E=l.visible,I=l.onCancel,C=l.onUpdated,y=u.Z.useForm(),p=(0,j.Z)(y,1),r=p[0];(0,f.useEffect)(function(){n&&Object.keys(n).length>0&&r.setFieldsValue((0,x.Z)((0,x.Z)({},n),{},{project_id:n.project_id?n.project_id:void 0,sort:n.sort?n.sort:void 0}))},[l.fields]);var Z=function(){I(r)},g=function(){r.validateFields().then(function(c){C((0,x.Z)((0,x.Z)({},c),{},{id:n.id}),r)}).catch(function(c){var B=c.errorFields;B.length>0&&m.default.error("\u8BF7\u5B8C\u6210\u5FC5\u586B\u9879\u5185\u5BB9")})};return(0,e.jsx)(N.Z,{title:"\u66F4\u65B0\u90E8\u95E8",width:450,visible:E,onClose:Z,maskClosable:!1,footer:(0,e.jsx)("div",{style:{textAlign:"right",marginRight:10},children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{onClick:Z,style:{marginRight:10},children:"\u5173\u95ED"}),(0,e.jsx)(D.Z,{type:"primary",onClick:g,style:{marginRight:10},children:"\u4FDD\u5B58"})]})}),children:(0,e.jsx)(u.Z,{layout:"vertical",form:r,onFinish:g,children:(0,e.jsxs)(M.Z,{gutter:[16,16],children:[(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"name",label:"\u90E8\u95E8\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90E8\u95E8\u540D\u79F0"}],children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u540D\u79F0"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"contact",label:"\u90E8\u95E8\u7535\u8BDD",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90E8\u95E8\u7535\u8BDD"}],children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u7535\u8BDD"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"description",label:"\u90E8\u95E8\u63CF\u8FF0",children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u90E8\u95E8\u63CF\u8FF0"})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"project_id",label:"\u6240\u5C5E\u9879\u76EE",children:(0,e.jsx)(G.Z,{allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u9879\u76EE",options:F})})}),(0,e.jsx)(o.Z,{span:24,children:(0,e.jsx)(u.Z.Item,{name:"sort",label:"\u6392\u5E8F",children:(0,e.jsx)(h.Z,{allowClear:!0,placeholder:"\u8BF7\u586B\u5199\u6392\u5E8F \u6B63\u5E8F\u6392\u5E8F"})})})]})})})},ee=_,te=function(l){var F=l.loading,n=l.dispatch,E=l.department.list,I=(0,f.useState)(),C=(0,j.Z)(I,2),y=C[0],p=C[1],r=(0,f.useState)({defaultExpandAllRows:!0}),Z=(0,j.Z)(r,1),g=Z[0],A=(0,f.useState)(!1),c=(0,j.Z)(A,2),B=c[0],U=c[1],ne=(0,f.useState)(!1),O=(0,j.Z)(ne,2),le=O[0],V=O[1],ue=(0,f.useState)({}),z=(0,j.Z)(ue,2),H=z[0],re=z[1],se=(0,f.useState)([]),J=(0,j.Z)(se,2),k=J[0],ie=J[1],T=(0,b.md)();(0,f.useEffect)(function(){R()},[]),(0,f.useEffect)(function(){var d=!1;return n({type:"department/project",callback:function(s){s.status==="success"&&(d||ie(s.data.map(function(v){return{value:v.id,label:v.name}}))),s.status==="fail"&&m.default.error(s.message)}}),function(){d=!0}},[]);var R=function(){n({type:"department/fetch"})},Q=function(a,s){n({type:"department/created",payload:(0,x.Z)({},a),callback:function(i){i.status==="success"&&(U(!1),R(),s.resetFields()),i.status==="fail"&&m.default.error(i.message)}})},de=function(a,s){n({type:"department/updated",payload:(0,x.Z)({},a),callback:function(i){i.status==="success"&&(V(!1),R()),i.status==="fail"&&m.default.error(i.message)}})},oe=function(a){console.log(a),a&&n({type:"department/deleted",payload:{id:a},callback:function(v){v.status==="success"&&R(),v.status==="fail"&&m.default.error(v.message)}})},ce=function(){var a=T.canDepartmentCreated;return a?(0,e.jsx)(D.Z,{type:"primary",onClick:function(){return U(!0)},children:"\u65B0\u589E"}):null},me=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:"20%",rules:[{required:!0,message:"\u6807\u9898\u4E3A\u5FC5\u586B\u9879"}]},{title:"\u90E8\u95E8\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u90E8\u95E8\u7535\u8BDD",dataIndex:"contact",key:"contact"},{title:"\u6240\u5C5E\u9879\u76EE",dataIndex:"project_name",key:"project_name",render:function(a){return a||"-"}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",sorter:!0,valueType:"dateTime",hideInForm:!0},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(a,s,v){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(b.Nv,{accessible:T.canDepartmentCreated,fallback:(0,e.jsx)("a",{style:{padding:0},onClick:function(){return m.default.error("\u60A8\u6CA1\u6709\u6743\u9650")},children:"-"}),children:(0,e.jsx)("a",{style:{padding:0},onClick:function(){p(s),U(!0)},children:"\u65B0\u589E"})},"a"),(0,e.jsx)($.Z,{type:"vertical"}),(0,e.jsx)(b.Nv,{accessible:T.canDepartmentUpdated,fallback:(0,e.jsx)("a",{style:{padding:0},onClick:function(){return m.default.error("\u60A8\u6CA1\u6709\u6743\u9650")},children:"-"}),children:(0,e.jsx)("a",{style:{padding:0},onClick:function(){re(s),V(!0)},children:"\u66F4\u65B0"})},"b"),(0,e.jsx)($.Z,{type:"vertical"}),(0,e.jsx)(b.Nv,{accessible:T.canDepartmentDeleted,fallback:(0,e.jsx)("a",{style:{padding:0},onClick:function(){return m.default.error("\u60A8\u6CA1\u6709\u6743\u9650")},children:"-"}),children:(0,e.jsx)(Y.Z,{title:"\u786E\u8BA4\u8981\u5220\u9664\u8BE5\u4FE1\u606F?",onConfirm:function(){return oe(s.id)},okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",children:(0,e.jsx)("a",{style:{padding:0},children:"\u5220\u9664"})})},"c")]})}}];return(0,e.jsx)(w.ZP,{children:(0,e.jsxs)(W.Z,{title:"\u5217\u8868",extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ce,{})}),children:[E&&E.length>0?(0,e.jsx)(X.Z,{rowKey:"id",pagination:!1,loading:F,columns:me,dataSource:E,expandable:g}):(0,e.jsx)(L.Z,{image:L.Z.PRESENTED_IMAGE_SIMPLE,description:(0,e.jsx)("span",{children:"\u6682\u65E0\u6570\u636E"})}),y?(0,e.jsx)(K,{visible:B,options:k,parent:y,onCreated:Q,onCancel:function(a){U(!1),p(void 0),a.resetFields()}}):(0,e.jsx)(K,{visible:B,options:k,onCreated:Q,onCancel:function(a){U(!1),a.resetFields()}}),H&&(0,e.jsx)(ee,{visible:le,options:k,fields:H,onUpdated:de,onCancel:function(a){V(!1),p(void 0),a.resetFields()}})]})})},ae=(0,b.$j)(function(S){var l=S.department,F=S.loading;return{department:l,loading:F.models.department}})(te)}}]);
